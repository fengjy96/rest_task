(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4e27","chunk-606a"],{"99or":function(t,e,s){"use strict";s.r(e);var a=s("QbLZ"),o=s.n(a),r=s("L2JU"),n=s("dUbn"),i=s("X4fA"),l=s("Q2AE"),c=s("wk8/"),d={name:"Center",components:{updatePass:n.default},data:function(){return{avatarUploadUrl:"http://192.168.239.129/api/v1/files/upload",headers:{Authorization:"Bearer "+Object(i.a)()},points:100,coins:100}},computed:o()({},Object(r.b)(["id","avatar","name","email","createTime"])),methods:{handleSuccess:function(t,e,s){200===t.code&&(this.$notify({title:"头像修改成功",type:"success",duration:2500}),l.a.dispatch("GetInfo").then(function(){}))},handleError:function(t,e,s){console.log("头像上传失败: ",t);try{var a=JSON.parse(t.message);this.$notify({title:a.message,type:"error",duration:2500})}catch(t){this.$notify({title:"头像上传失败",type:"error",duration:2500})}},getUserPoints:function(){var t=this;Object(c.e)().then(function(e){e&&200===e.code&&e.detail&&(t.points=e.detail.total_points,t.coins=e.detail.total_coins)}).catch(function(t){console.log(t)})},init:function(){this.getUserPoints()}},created:function(){var t=this;this.$nextTick(function(){t.init()})}},u=(s("fnfW"),s("KHd+")),p=Object(u.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticStyle:{width:"600px"},attrs:{id:"content-main"}},[s("el-card",{staticClass:"box-card user-info",attrs:{shadow:"never"}},[s("div",{staticClass:"avatar-content"},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.avatarUploadUrl,headers:t.headers,"show-file-list":!1,"on-success":t.handleSuccess,"on-error":t.handleError}},[t.avatar?s("img",{staticClass:"avatar",attrs:{src:t.avatar,title:"点击上传头像",alt:""}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),s("div",{staticClass:"user-info-content"},[s("div",[t._v("登录账号："+t._s(t.name))]),t._v(" "),s("div",[t._v("注册时间："+t._s(t.createTime))]),t._v(" "),s("div",[t._v("账号状态："),s("span",{staticStyle:{color:"#909399"}},[t._v("正常")])]),t._v(" "),s("div",[t._v("积分："+t._s(t.points)+"        米值："+t._s(t.coins))])])]),t._v(" "),s("el-card",{staticClass:"box-card reset-pass",attrs:{shadow:"never"}},[s("h4",{staticClass:"account-label-icon"},[t._v("登录密码：")]),t._v(" "),s("updatePass",{attrs:{id:t.id}}),t._v(" "),s("p",[t._v("安全性高的密码可使账号更安全，建议设置同时包含字母，数字，符号的密码。")])],1)],1)])},[],!1,null,null,null);p.options.__file="center.vue";e.default=p.exports},HZIk:function(t,e,s){},dUbn:function(t,e,s){"use strict";s.r(e);var a=s("Q2AE"),o=s("wk8/"),r={props:{id:{type:Number,required:!0}},data:function(){var t=this;return{loading:!1,dialog:!1,title:"修改密码",form:{old_password:"",new_password1:"",new_password2:""},rules:{old_password:[{required:!0,message:"请输入密码",trigger:"blur"}],new_password1:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],new_password2:[{required:!0,validator:function(e,s,a){t.form.new_password1!==s?a(new Error("两次输入的密码不一致")):a()},trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,Object(o.f)(t.id,t.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"密码修改成功!请重新登录!",duration:2500}),setTimeout(function(){a.a.dispatch("LogOut").then(function(){location.reload()})},1500)}).catch(function(e){t.loading=!1,console.log(e)})})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),this.form={old_password:"",new_password1:"",new_password2:""}}}},n=(s("qy4e"),s("KHd+")),i=Object(n.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{display:"inline-block"}},[s("el-button",{staticClass:"button",attrs:{size:"mini",type:"info"},on:{click:function(e){t.dialog=!0}}},[t._v("修改")]),t._v(" "),s("el-dialog",{attrs:{visible:t.dialog,title:t.title,width:"500px"},on:{"update:visible":function(e){t.dialog=e},close:t.cancel}},[s("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small","label-width":"88px"}},[s("el-form-item",{attrs:{label:"旧密码",prop:"old_password"}},[s("el-input",{staticStyle:{width:"370px"},attrs:{type:"password","auto-complete":"on"},model:{value:t.form.old_password,callback:function(e){t.$set(t.form,"old_password",e)},expression:"form.old_password"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"新密码",prop:"new_password1"}},[s("el-input",{staticStyle:{width:"370px"},attrs:{type:"password","auto-complete":"on"},model:{value:t.form.new_password1,callback:function(e){t.$set(t.form,"new_password1",e)},expression:"form.new_password1"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"确认密码",prop:"new_password2"}},[s("el-input",{staticStyle:{width:"370px"},attrs:{type:"password","auto-complete":"on"},model:{value:t.form.new_password2,callback:function(e){t.$set(t.form,"new_password2",e)},expression:"form.new_password2"}})],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)],1)},[],!1,null,"6b4f5320",null);i.options.__file="updatePass.vue";e.default=i.exports},fnfW:function(t,e,s){"use strict";var a=s("HZIk");s.n(a).a},qPlM:function(t,e,s){},qy4e:function(t,e,s){"use strict";var a=s("qPlM");s.n(a).a},"wk8/":function(t,e,s){"use strict";s.d(e,"a",function(){return o}),s.d(e,"b",function(){return r}),s.d(e,"c",function(){return n}),s.d(e,"f",function(){return i}),s.d(e,"d",function(){return l}),s.d(e,"e",function(){return c});var a=s("t3Un");function o(t){return Object(a.a)({url:"api/users/",method:"post",data:t})}function r(t){return Object(a.a)({url:"api/users/"+t+"/",method:"delete"})}function n(t,e){return Object(a.a)({url:"api/users/"+t+"/",method:"put",data:e})}function i(t,e){return Object(a.a)({url:"api/users/"+t+"/change-passwd/",method:"post",data:e})}function l(t){return t?Object(a.a)({url:"api/user/list/?name="+t,method:"get"}):Object(a.a)({url:"api/user/list/",method:"get"})}function c(){return Object(a.a)({url:"api/v1/points",method:"get"})}}}]);