(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d8d","chunk-4b92"],{"/xFh":function(t,e,r){},"02iu":function(t,e,r){"use strict";r.d(e,"d",function(){return s}),r.d(e,"e",function(){return a}),r.d(e,"a",function(){return o}),r.d(e,"b",function(){return l}),r.d(e,"c",function(){return n});var i=r("t3Un");function s(){return Object(i.a)({url:"api/organization/tree/",method:"get"})}function a(){return Object(i.a)({url:"api/organization/user/tree/",method:"get"})}function o(t){return Object(i.a)({url:"api/organizations/",method:"post",data:t})}function l(t){return Object(i.a)({url:"api/organizations/"+t+"/",method:"delete"})}function n(t,e){return Object(i.a)({url:"api/organizations/"+t+"/",method:"put",data:e})}},"25vb":function(t,e,r){"use strict";var i=r("e8rh");r.n(i).a},"2Bqp":function(t,e,r){"use strict";var i=r("/xFh");r.n(i).a},YOUW:function(t,e,r){"use strict";r.r(e);var i=r("fIwS"),s=r("02iu"),a={components:{eForm:i.default},props:{organizations:{type:Array,required:!0},roles:{type:Array,required:!0},data:{type:Object,required:!0},sup_this:{type:Object,required:!0}},data:function(){return{orgusers:[]}},methods:{to:function(){var t=this,e=this.$refs.form;e.roleIds=[],e.skillIds=[];var r=null;null!==this.data.department&&(r=this.data.department.id);var i=null;null!==this.data.superior&&(i=this.data.superior.id),e.form={id:this.data.id,username:this.data.username,name:this.data.name,email:this.data.email,mobile:this.data.mobile,is_active:this.data.is_active.toString(),department:r,superior:i,position:this.data.position,roles:[],skills:[],base_salary:0},this.data.skills.forEach(function(t,r){e.skillIds.push(t.id)}),this.data.roles.forEach(function(t,r){e.roleIds.push(t.id)}),e.dialog=!0,Object(s.e)().then(function(e){t.orgusers=e.detail})}}},o=(r("25vb"),r("KHd+")),l=Object(o.a)(a,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-button",{attrs:{disabled:1===t.data.id,size:"mini",type:"success"},on:{click:t.to}},[t._v("编辑")]),t._v(" "),r("eForm",{ref:"form",attrs:{roles:t.roles,organizations:t.organizations,orgusers:t.orgusers,sup_this:t.sup_this,"is-add":!1}})],1)},[],!1,null,"faa441a4",null);l.options.__file="edit.vue";e.default=l.exports},Yfch:function(t,e,r){"use strict";function i(t){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(t)}function s(t){return/^[a-zA-Z0-9_]+$/g.test(t)}r.d(e,"b",function(){return i}),r.d(e,"a",function(){return s})},e8rh:function(t,e,r){},fIwS:function(t,e,r){"use strict";r.r(e);var i=r("QbLZ"),s=r.n(i),a=r("wk8/"),o=r("cCY5"),l=r.n(o),n=(r("VCwm"),r("Yfch")),u=function(t,e,r){e?Object(n.b)(e)?r():r(new Error("请输入正确的11位手机号码")):r(new Error("请输入手机号码"))},c={name:"Form",components:{Treeselect:l.a},props:{organizations:{type:Array,required:!0},orgusers:{type:Array,required:!0},roles:{type:Array,required:!0},isAdd:{type:Boolean,required:!0},sup_this:{type:Object,default:null}},data:function(){return{dialog:!1,loading:!1,form:{username:"",name:"",mobile:"",department:null,superior:null,position:"",email:"",is_active:"false",roles:[],skills:[],base_salary:0},roleIds:[],skills:[],skillIds:[],rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{message:"请输入邮箱地址",trigger:"blur",required:!0},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",validator:u}],is_active:[{required:!0,message:"状态不能为空",trigger:"blur"}],base_salary:[]}}},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,t.form.roles=[];var r=t;t.roleIds.forEach(function(t,e){r.form.roles.push(t)}),t.skillIds.forEach(function(t){r.form.skills.push(t)}),t.isAdd?t.doAdd():t.doEdit()})},doAdd:function(){var t=this;Object(a.a)(this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"添加成功!默认密码123456!",duration:2500}),t.loading=!1,t.$parent.$parent.init()}).catch(function(e){t.loading=!1,console.log(e)})},doEdit:function(){var t=this;Object(a.c)(this.form.id,this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"修改成功!",duration:2500}),t.loading=!1,t.sup_this.init()}).catch(function(e){t.loading=!1,console.log(e)})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),this.roleIds=[],this.skillIds=[],this.form={username:"",name:"",mobile:"",department:null,superior:null,position:"",email:"",is_active:"false",roles:[],skills:[],base_salary:0}},init:function(){this.getSkills()},getSkills:function(){var t=this.$store.state.task.types||[];this.skills=t.map(function(t){return s()({},t,{label:t.name})})}},created:function(){var t=this;this.$nextTick(function(){t.init()})}},d=(r("2Bqp"),r("KHd+")),m=Object(d.a)(c,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{width:"850px","append-to-body":!0,visible:t.dialog,title:t.isAdd?"新增用户":"编辑用户"},on:{"update:visible":function(e){t.dialog=e}}},[r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small","label-width":"80px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{disabled:!1===t.isAdd},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{staticStyle:{width:"300px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{staticStyle:{width:"300px"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{staticStyle:{width:"300px"},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"状态",prop:"is_active"}},[r("el-radio",{attrs:{label:"true"},model:{value:t.form.is_active,callback:function(e){t.$set(t.form,"is_active",e)},expression:"form.is_active"}},[t._v("激活")]),t._v(" "),r("el-radio",{attrs:{label:"false"},model:{value:t.form.is_active,callback:function(e){t.$set(t.form,"is_active",e)},expression:"form.is_active"}},[t._v("锁定")])],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"部门"}},[r("treeselect",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择部门",options:t.organizations},model:{value:t.form.department,callback:function(e){t.$set(t.form,"department",e)},expression:"form.department"}})],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"职位",prop:"position"}},[r("el-input",{staticStyle:{width:"300px"},model:{value:t.form.position,callback:function(e){t.$set(t.form,"position",e)},expression:"form.position"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"上级主管"}},[r("treeselect",{staticStyle:{width:"300px"},attrs:{options:t.orgusers,"disable-branch-nodes":!0,placeholder:"请选择上级主管"},model:{value:t.form.superior,callback:function(e){t.$set(t.form,"superior",e)},expression:"form.superior"}})],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"基本工资"}},[r("el-input",{staticStyle:{width:"300px"},model:{value:t.form.base_salary,callback:function(e){t.$set(t.form,"base_salary",t._n(e))},expression:"form.base_salary"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"角色"}},[r("treeselect",{staticStyle:{width:"300px"},attrs:{multiple:!0,options:t.roles,placeholder:"请选择角色"},model:{value:t.roleIds,callback:function(e){t.roleIds=e},expression:"roleIds"}})],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"技能"}},[r("treeselect",{staticStyle:{width:"300px"},attrs:{multiple:!0,options:t.skills,placeholder:"请选择技能"},model:{value:t.skillIds,callback:function(e){t.skillIds=e},expression:"skillIds"}})],1)],1)],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)},[],!1,null,"02d7ea3a",null);m.options.__file="form.vue";e.default=m.exports},"wk8/":function(t,e,r){"use strict";r.d(e,"a",function(){return s}),r.d(e,"b",function(){return a}),r.d(e,"c",function(){return o}),r.d(e,"f",function(){return l}),r.d(e,"d",function(){return n}),r.d(e,"e",function(){return u});var i=r("t3Un");function s(t){return Object(i.a)({url:"api/users/",method:"post",data:t})}function a(t){return Object(i.a)({url:"api/users/"+t+"/",method:"delete"})}function o(t,e){return Object(i.a)({url:"api/users/"+t+"/",method:"put",data:e})}function l(t,e){return Object(i.a)({url:"api/users/"+t+"/change-passwd/",method:"post",data:e})}function n(t){return t?Object(i.a)({url:"api/user/list/?name="+t,method:"get"}):Object(i.a)({url:"api/user/list/",method:"get"})}function u(){return Object(i.a)({url:"api/v1/points",method:"get"})}}}]);